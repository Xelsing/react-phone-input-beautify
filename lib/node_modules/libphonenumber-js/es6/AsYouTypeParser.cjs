"use client";"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const b=require("./helpers/extractCountryCallingCode.cjs"),C=require("./helpers/extractCountryCallingCodeFromInternationalNumberWithoutPlusSign.cjs"),s=require("./helpers/extractNationalNumberFromPossiblyIncompleteNumber.cjs"),y=require("./helpers/stripIddPrefix.cjs"),x=require("./helpers/parseDigits.cjs"),c=require("./constants.cjs");function m(n,e){return S(n)||P(n,e)||I(n,e)||v()}function v(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I(n,e){if(n){if(typeof n=="string")return g(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(n,e)}}function g(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function P(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i=[],a=!0,r=!1,u,l;try{for(t=t.call(n);!(a=(u=t.next()).done)&&(i.push(u.value),!(e&&i.length===e));a=!0);}catch(o){r=!0,l=o}finally{try{!a&&t.return!=null&&t.return()}finally{if(r)throw l}}return i}}function S(n){if(Array.isArray(n))return n}function A(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function N(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _(n,e,t){return e&&N(n.prototype,e),t&&N(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}var D="["+c.VALID_PUNCTUATION+c.VALID_DIGITS+"]+",T=new RegExp("^"+D+"$","i"),p="(?:["+c.PLUS_CHARS+"]["+c.VALID_PUNCTUATION+c.VALID_DIGITS+"]*|["+c.VALID_PUNCTUATION+c.VALID_DIGITS+"]+)",E=new RegExp("[^"+c.VALID_PUNCTUATION+c.VALID_DIGITS+"]+.*$"),O=/[^\d\[\]]/,R=function(){function n(e){var t=e.defaultCountry,i=e.defaultCallingCode,a=e.metadata,r=e.onNationalSignificantNumberChange;A(this,n),this.defaultCountry=t,this.defaultCallingCode=i,this.metadata=a,this.onNationalSignificantNumberChange=r}return _(n,[{key:"input",value:function(t,i){var a=h(t),r=m(a,2),u=r[0],l=r[1],o=x.default(u),f;return l&&(i.digits||(i.startInternationalNumber(),o||(f=!0))),o&&this.inputDigits(o,i),{digits:o,justLeadingPlus:f}}},{key:"inputDigits",value:function(t,i){var a=i.digits,r=a.length<3&&a.length+t.length>=3;if(i.appendDigits(t),r&&this.extractIddPrefix(i),this.isWaitingForCountryCallingCode(i)){if(!this.extractCountryCallingCode(i))return}else i.appendNationalSignificantNumberDigits(t);i.international||this.hasExtractedNationalSignificantNumber||this.extractNationalSignificantNumber(i.getNationalDigits(),function(u){return i.update(u)})}},{key:"isWaitingForCountryCallingCode",value:function(t){var i=t.international,a=t.callingCode;return i&&!a}},{key:"extractCountryCallingCode",value:function(t){var i=b("+"+t.getDigitsWithoutInternationalPrefix(),this.defaultCountry,this.defaultCallingCode,this.metadata.metadata),a=i.countryCallingCode,r=i.number;if(a)return t.setCallingCode(a),t.update({nationalSignificantNumber:r}),!0}},{key:"reset",value:function(t){if(t){this.hasSelectedNumberingPlan=!0;var i=t._nationalPrefixForParsing();this.couldPossiblyExtractAnotherNationalSignificantNumber=i&&O.test(i)}else this.hasSelectedNumberingPlan=void 0,this.couldPossiblyExtractAnotherNationalSignificantNumber=void 0}},{key:"extractNationalSignificantNumber",value:function(t,i){if(this.hasSelectedNumberingPlan){var a=s(t,this.metadata),r=a.nationalPrefix,u=a.nationalNumber,l=a.carrierCode;if(u!==t)return this.onExtractedNationalNumber(r,l,u,t,i),!0}}},{key:"extractAnotherNationalSignificantNumber",value:function(t,i,a){if(!this.hasExtractedNationalSignificantNumber)return this.extractNationalSignificantNumber(t,a);if(this.couldPossiblyExtractAnotherNationalSignificantNumber){var r=s(t,this.metadata),u=r.nationalPrefix,l=r.nationalNumber,o=r.carrierCode;if(l!==i)return this.onExtractedNationalNumber(u,o,l,t,a),!0}}},{key:"onExtractedNationalNumber",value:function(t,i,a,r,u){var l,o,f=r.lastIndexOf(a);if(f>=0&&f===r.length-a.length){o=!0;var d=r.slice(0,f);d!==t&&(l=d)}u({nationalPrefix:t,carrierCode:i,nationalSignificantNumber:a,nationalSignificantNumberMatchesInput:o,complexPrefixBeforeNationalSignificantNumber:l}),this.hasExtractedNationalSignificantNumber=!0,this.onNationalSignificantNumberChange()}},{key:"reExtractNationalSignificantNumber",value:function(t){if(this.extractAnotherNationalSignificantNumber(t.getNationalDigits(),t.nationalSignificantNumber,function(i){return t.update(i)}))return!0;if(this.extractIddPrefix(t))return this.extractCallingCodeAndNationalSignificantNumber(t),!0;if(this.fixMissingPlus(t))return this.extractCallingCodeAndNationalSignificantNumber(t),!0}},{key:"extractIddPrefix",value:function(t){var i=t.international,a=t.IDDPrefix,r=t.digits;if(t.nationalSignificantNumber,!(i||a)){var u=y(r,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata);if(u!==void 0&&u!==r)return t.update({IDDPrefix:r.slice(0,r.length-u.length)}),this.startInternationalNumber(t,{country:void 0,callingCode:void 0}),!0}}},{key:"fixMissingPlus",value:function(t){if(!t.international){var i=C(t.digits,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata),a=i.countryCallingCode;if(i.number,a)return t.update({missingPlus:!0}),this.startInternationalNumber(t,{country:t.country,callingCode:a}),!0}}},{key:"startInternationalNumber",value:function(t,i){var a=i.country,r=i.callingCode;t.startInternationalNumber(a,r),t.nationalSignificantNumber&&(t.resetNationalSignificantNumber(),this.onNationalSignificantNumberChange(),this.hasExtractedNationalSignificantNumber=void 0)}},{key:"extractCallingCodeAndNationalSignificantNumber",value:function(t){this.extractCountryCallingCode(t)&&this.extractNationalSignificantNumber(t.getNationalDigits(),function(i){return t.update(i)})}}]),n}();function F(n){var e=n.search(p);if(!(e<0)){n=n.slice(e);var t;return n[0]==="+"&&(t=!0,n=n.slice(1)),n=n.replace(E,""),t&&(n="+"+n),n}}function L(n){var e=F(n)||"";return e[0]==="+"?[e.slice(1),!0]:[e]}function h(n){var e=L(n),t=m(e,2),i=t[0],a=t[1];return T.test(i)||(i=""),[i,a]}exports.default=R;exports.extractFormattedDigitsAndPlus=h;
